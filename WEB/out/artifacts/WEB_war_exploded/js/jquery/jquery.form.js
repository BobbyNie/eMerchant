/*
 * jQuery Form Plugin
 * version: 2.43 (12-MAR-2010)
 * @requires jQuery v1.3.2 or later
 *
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */
(function(B){B.fn.ajaxSubmit=function(C){if(!this.length){A("ajaxSubmit: skipping submit process - no element selected");return this}if(typeof C=="function"){C={success:C}}var G=B.trim(this.attr("action"));if(G){G=(G.match(/^([^#]+)/)||[])[1]}G=G||window.location.href||"";C=B.extend({url:G,type:this.attr("method")||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},C||{});var O={};this.trigger("form-pre-serialize",[this,C,O]);if(O.veto){A("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(C.beforeSerialize&&C.beforeSerialize(this,C)===false){A("ajaxSubmit: submit aborted via beforeSerialize callback");return this}var H=this.formToArray(C.semantic);if(C.data){C.extraData=C.data;for(var F in C.data){if(C.data[F] instanceof Array){for(var E in C.data[F]){H.push({name:F,value:C.data[F][E]})}}else{H.push({name:F,value:C.data[F]})}}}if(C.beforeSubmit&&C.beforeSubmit(H,this,C)===false){A("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[H,this,C,O]);if(O.veto){A("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}var M=B.param(H);if(C.type.toUpperCase()=="GET"){C.url+=(C.url.indexOf("?")>=0?"&":"?")+M;C.data=null}else{C.data=M}var K=this,I=[];if(C.resetForm){I.push(function(){K.resetForm()})}if(C.clearForm){I.push(function(){K.clearForm()})}if(!C.dataType&&C.target){var N=C.success||function(){};I.push(function(S){var R=C.replaceTarget?"replaceWith":"html";B(C.target)[R](S).each(N,arguments)})}else{if(C.success){I.push(C.success)}}C.success=function(V,R,U){for(var S=0,T=I.length;S<T;S++){I[S].apply(C,[V,R,U||K,K])}};var J=B("input:file",this).fieldValue();var L=false;for(var D=0;D<J.length;D++){if(J[D]){L=true}}var Q=false;if((J.length&&C.iframe!==false)||C.iframe||L||Q){if(C.closeKeepAlive){B.get(C.closeKeepAlive,P)}else{P()}}else{B.ajax(C)}this.trigger("form-submit-notify",[this,C]);return this;function P(){var U=K[0];if(B(":input[name=submit]",U).length){alert('Error: Form elements must not be named "submit".');return}var h=B.extend({},B.ajaxSettings,C);var c=B.extend(true,{},B.extend(true,{},B.ajaxSettings),h);var R="jqFormIO"+(new Date().getTime());var W=B('<iframe id="'+R+'" name="'+R+'" src="'+h.iframeSrc+'" onload="(jQuery(this).data(\'form-plugin-onload\'))()" />');var S=W[0];W.css({position:"absolute",top:"-1000px",left:"-1000px"});var Z={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(){this.aborted=1;W.attr("src",h.iframeSrc)}};var X=h.global;if(X&&!B.active++){B.event.trigger("ajaxStart")}if(X){B.event.trigger("ajaxSend",[Z,h])}if(c.beforeSend&&c.beforeSend(Z,c)===false){c.global&&B.active--;return}if(Z.aborted){return}var f=false;var Y=0;var e=U.clk;if(e){var b=e.name;if(b&&!e.disabled){h.extraData=h.extraData||{};h.extraData[b]=e.value;if(e.type=="image"){h.extraData[b+".x"]=U.clk_x;h.extraData[b+".y"]=U.clk_y}}}function T(){var i=K.attr("target"),j=K.attr("action");U.setAttribute("target",R);if(U.getAttribute("method")!="POST"){U.setAttribute("method","POST")}if(U.getAttribute("action")!=h.url){U.setAttribute("action",h.url)}if(!h.skipEncodingOverride){K.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"})}if(h.timeout){setTimeout(function(){Y=true;d()},h.timeout)}var k=[];try{if(h.extraData){for(var g in h.extraData){k.push(B('<input type="hidden" name="'+g+'" value="'+h.extraData[g]+'" />').appendTo(U)[0])}}W.appendTo("body");W.data("form-plugin-onload",d);U.submit()}finally{U.setAttribute("action",j);i?U.setAttribute("target",i):K.removeAttr("target");B(k).remove()}}if(h.forceSync){T()}else{setTimeout(T,10)}var a=100;function d(){if(f){return}var n=true;try{if(Y){throw"timeout"}var k,i;i=S.contentWindow?S.contentWindow.document:S.contentDocument?S.contentDocument:S.document;var l=h.dataType=="xml"||i.XMLDocument||B.isXMLDoc(i);A("isXml="+l);if(!l&&(i.body==null||i.body.innerHTML=="")){if(--a){A("requeing onLoad callback, DOM not available");setTimeout(d,250);return}A("Could not access iframe DOM after 100 tries.");return}A("response detected");f=true;Z.responseText=i.body?i.body.innerHTML:null;Z.responseXML=i.XMLDocument?i.XMLDocument:i;Z.getResponseHeader=function(p){var o={"content-type":h.dataType};return o[p]};if(h.dataType=="json"||h.dataType=="script"){var m=i.getElementsByTagName("textarea")[0];if(m){Z.responseText=m.value}else{var g=i.getElementsByTagName("pre")[0];if(g){Z.responseText=g.innerHTML}}}else{if(h.dataType=="xml"&&!Z.responseXML&&Z.responseText!=null){Z.responseXML=V(Z.responseText)}}k=B.httpData(Z,h.dataType)}catch(j){A("error caught:",j);n=false;Z.error=j;B.handleError(h,Z,"error",j)}if(n){h.success(k,"success");if(X){B.event.trigger("ajaxSuccess",[Z,h])}}if(X){B.event.trigger("ajaxComplete",[Z,h])}if(X&&!--B.active){B.event.trigger("ajaxStop")}if(h.complete){h.complete(Z,n?"success":"error")}setTimeout(function(){W.removeData("form-plugin-onload");W.remove();Z.responseXML=null},100)}function V(g,i){if(window.ActiveXObject){i=new ActiveXObject("Microsoft.XMLDOM");i.async="false";i.loadXML(g)}else{i=(new DOMParser()).parseFromString(g,"text/xml")}return(i&&i.documentElement&&i.documentElement.tagName!="parsererror")?i:null}}};B.fn.ajaxForm=function(C){return this.ajaxFormUnbind().bind("submit.form-plugin",function(D){D.preventDefault();B(this).ajaxSubmit(C)}).bind("click.form-plugin",function(H){var F=H.target;var D=B(F);if(!(D.is(":submit,input:image"))){var I=D.closest(":submit");if(I.length==0){return}F=I[0]}var G=this;G.clk=F;if(F.type=="image"){if(H.offsetX!=undefined){G.clk_x=H.offsetX;G.clk_y=H.offsetY}else{if(typeof B.fn.offset=="function"){var E=D.offset();G.clk_x=H.pageX-E.left;G.clk_y=H.pageY-E.top}else{G.clk_x=H.pageX-F.offsetLeft;G.clk_y=H.pageY-F.offsetTop}}}setTimeout(function(){G.clk=G.clk_x=G.clk_y=null},100)})};B.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};B.fn.formToArray=function(M){var H=[];if(this.length==0){return H}var F=this[0];var G=M?F.getElementsByTagName("*"):F.elements;if(!G){return H}for(var C=0,L=G.length;C<L;C++){var J=G[C];var O=J.name;if(!O){continue}if(M&&F.clk&&J.type=="image"){if(!J.disabled&&F.clk==J){H.push({name:O,value:B(J).val()});H.push({name:O+".x",value:F.clk_x},{name:O+".y",value:F.clk_y})}continue}var N=B.fieldValue(J,true);if(N&&N.constructor==Array){for(var D=0,I=N.length;D<I;D++){H.push({name:O,value:N[D]})}}else{if(N!==null&&typeof N!="undefined"){H.push({name:O,value:N})}}}if(!M&&F.clk){var E=B(F.clk),K=E[0],O=K.name;if(O&&!K.disabled&&K.type=="image"){H.push({name:O,value:E.val()});H.push({name:O+".x",value:F.clk_x},{name:O+".y",value:F.clk_y})}}return H};B.fn.formSerialize=function(C){return B.param(this.formToArray(C))};B.fn.fieldSerialize=function(C){var D=[];this.each(function(){var E=this.name;if(!E){return}var F=B.fieldValue(this,C);if(F&&F.constructor==Array){for(var G=0,H=F.length;G<H;G++){D.push({name:E,value:F[G]})}}else{if(F!==null&&typeof F!="undefined"){D.push({name:this.name,value:F})}}});return B.param(D)};B.fn.fieldValue=function(C){for(var H=[],F=0,G=this.length;F<G;F++){var D=this[F];var E=B.fieldValue(D,C);if(E===null||typeof E=="undefined"||(E.constructor==Array&&!E.length)){continue}E.constructor==Array?B.merge(H,E):H.push(E)}return H};B.fieldValue=function(H,C){var D=H.name,N=H.type,I=H.tagName.toLowerCase();if(typeof C=="undefined"){C=true}if(C&&(!D||H.disabled||N=="reset"||N=="button"||(N=="checkbox"||N=="radio")&&!H.checked||(N=="submit"||N=="image")&&H.form&&H.form.clk!=H||I=="select"&&H.selectedIndex==-1)){return null}if(I=="select"){var G=H.selectedIndex;if(G<0){return null}var F=[],J=H.options;var E=(N=="select-one");var K=(E?G+1:J.length);for(var M=(E?G:0);M<K;M++){var O=J[M];if(O.selected){var L=O.value;if(!L){L=(O.attributes&&O.attributes["value"]&&!(O.attributes["value"].specified))?O.text:O.value}if(E){return L}F.push(L)}}return F}return H.value};B.fn.clearForm=function(){return this.each(function(){B("input,select,textarea",this).clearFields()})};B.fn.clearFields=B.fn.clearInputs=function(){return this.each(function(){var D=this.type,C=this.tagName.toLowerCase();if(D=="text"||D=="password"||C=="textarea"){this.value=""}else{if(D=="checkbox"||D=="radio"){this.checked=false}else{if(C=="select"){this.selectedIndex=-1}}}})};B.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=="function"||(typeof this.reset=="object"&&!this.reset.nodeType)){this.reset()}})};B.fn.enable=function(C){if(C==undefined){C=true}return this.each(function(){this.disabled=!C})};B.fn.selected=function(C){if(C==undefined){C=true}return this.each(function(){var E=this.type;if(E=="checkbox"||E=="radio"){this.checked=C}else{if(this.tagName.toLowerCase()=="option"){var D=B(this).parent("select");if(C&&D[0]&&D[0].type=="select-one"){D.find("option").selected(false)}this.selected=C}}})};function A(){if(B.fn.ajaxSubmit.debug){var C="[jquery.form] "+Array.prototype.join.call(arguments,"");if(window.console&&window.console.log){window.console.log(C)}else{if(window.opera&&window.opera.postError){window.opera.postError(C)}}}}})(jQuery);